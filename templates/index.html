<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Popsicle</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    
    /* Left nav button hover with tooltip via title attribute is added inline below */
    .nav-btn {
      transition: transform 0.2s ease, background-color 0.2s ease;
      cursor: pointer;
    }
    .nav-btn:hover {
      transform: scale(1.1);
      background-color: #1f2937;
    }
    
    /* Set default canvas cursor */
    canvas { cursor: grab; }
    
    #bottom-panel {
      transition: max-height 0.3s ease-in-out;
    }
    /* Layers panel header glass effect */
    #layers-header {
      position: sticky;
      top: 0;
      background: rgba(33,33,33,0.8);
      backdrop-filter: blur(8px);
      z-index: 10;
      padding: 0.5rem 1rem;
    }
    /* The overlay for the selected layer â€“ used for resizing and rotating */
    #resize-overlay {
      border: 2px dashed #10b981;
      position: absolute;
      pointer-events: none;
    }
    /* Resizing handles for all sides */
    .resize-handle {
      width: 12px;
      height: 12px;
      background: #10b981;
      position: absolute;
      border-radius: 50%;
      cursor: pointer;
      pointer-events: all;
    }
    .handle-nw { top: -6px; left: -6px; cursor: nw-resize; }
    .handle-n { top: -6px; left: calc(50% - 6px); cursor: n-resize; }
    .handle-ne { top: -6px; right: -6px; cursor: ne-resize; }
    .handle-e { top: calc(50% - 6px); right: -6px; cursor: e-resize; }
    .handle-se { bottom: -6px; right: -6px; cursor: se-resize; }
    .handle-s { bottom: -6px; left: calc(50% - 6px); cursor: s-resize; }
    .handle-sw { bottom: -6px; left: -6px; cursor: sw-resize; }
    .handle-w { top: calc(50% - 6px); left: -6px; cursor: w-resize; }
    
    /* Rotate handle positioned above the top center */
    .rotate-handle {
      width: 12px;
      height: 12px;
      background: #f59e0b;
      position: absolute;
      left: calc(50% - 6px);
      top: -30px;
      border-radius: 50%;
      cursor: grab;
      pointer-events: all;
    }
  </style>
</head>
<body class="bg-[#0f0f0f] text-white font-['Inter'] flex flex-col h-screen overflow-hidden p-4">
  <!-- Navigation Panel with tooltips -->
  <nav class="fixed left-4 top-4 h-[calc(100vh-32px)] w-12 bg-[#212121] border border-neutral-800 flex flex-col items-center py-4 space-y-6 rounded-2xl overflow-visible">
    <button class="nav-btn" title="Layers" data-action="layers" onclick="handleNavAction('layers')">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
      </svg>
    </button>

    <button class="nav-btn" title="Assets" data-action="assets" onclick="handleNavAction('assets')">
      <!-- Changed Assets SVG (using a photograph icon) -->
      <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7h18M3 7a2 2 0 012-2h3.5a2 2 0 011.79 1.11L12 10.25l1.71-3.14A2 2 0 0115.5 5H19a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V7z" />
      </svg>
    </button>

    <button class="nav-btn" title="Remove Background" data-action="removeBg" onclick="handleNavAction('removeBg')">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
      </svg>
    </button>

    <button class="nav-btn" title="Download" data-action="download" onclick="handleNavAction('download')">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
      </svg>
    </button>
  </nav>

  <!-- Main Content -->
  <div class="pl-20 pr-4 flex h-full">
    <!-- Canvas Container -->
    <div class="flex-1 relative overflow-hidden rounded-2xl bg-[#0f0f0f] border border-neutral-800">
      <canvas id="mainCanvas" class="w-full h-full"></canvas>
      <!-- Resizing overlay for selected image with multiple handles -->
      <div id="resize-overlay" class="hidden">
        <div class="resize-handle handle-nw" data-handle="nw"></div>
        <div class="resize-handle handle-n" data-handle="n"></div>
        <div class="resize-handle handle-ne" data-handle="ne"></div>
        <div class="resize-handle handle-e" data-handle="e"></div>
        <div class="resize-handle handle-se" data-handle="se"></div>
        <div class="resize-handle handle-s" data-handle="s"></div>
        <div class="resize-handle handle-sw" data-handle="sw"></div>
        <div class="resize-handle handle-w" data-handle="w"></div>
        <div class="rotate-handle" data-handle="rotate"></div>
      </div>
      <div class="absolute top-4 left-1/2 -translate-x-1/2 w-full max-w-3xl">
        <textarea 
          placeholder="Write a prompt" 
          rows="1"
          class="bg-[#212121] min-h-[56px] w-full px-6 py-4 pr-24 outline-none focus:ring-2 focus:ring-emerald-500 transition-all duration-300 placeholder:text-gray-400 resize-none overflow-hidden rounded-[28px] focus:rounded-3xl"
        ></textarea>
        <!-- Arrow button for prompt generation -->
        <div class="absolute top-1/2 right-4 -translate-y-1/2 group">
          <button id="prompt-arrow" class="relative inline-flex items-center justify-center p-px font-semibold leading-6 text-white bg-neutral-900 shadow-2xl cursor-pointer rounded-full shadow-emerald-900 transition-all duration-300 ease-in-out hover:scale-105 active:scale-95 hover:shadow-emerald-600 text-sm">
            <span class="absolute inset-0 rounded-full bg-gradient-to-r from-emerald-500 via-cyan-500 to-sky-600 p-[2px] opacity-0 transition-opacity duration-500 group-hover:opacity-100"></span>
            <span class="relative z-10 block p-2 rounded-full bg-neutral-950">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 transition-all duration-500 group-hover:translate-x-1 group-hover:text-emerald-300">
                <path d="M16.172 11l-5.364-5.364 1.414-1.414L20 12l-7.778 7.778-1.414-1.414L16.172 13H4v-2z"></path>
              </svg>
            </span>
          </button>
        </div>
      </div>
    </div>

    <!-- Right Panel -->
    <div id="right-panel" class="w-80 bg-[#212121] border-l border-neutral-800 h-full flex flex-col">
      <!-- Layers panel with fixed header and glass effect -->
      <div id="layers-panel" class="flex-1 overflow-y-auto no-scrollbar">
        <div id="layers-header" class="text-white font-medium text-lg">Layers</div>
        <div id="layers-list" class="space-y-3 p-2"></div>
      </div>
      <div id="bottom-panel" class="border-t border-neutral-800 overflow-hidden" style="max-height: 0;">
        <!-- Assets Panel with glass effect -->
        <div id="assets-panel" class="p-6 overflow-y-auto max-h-[400px] hidden no-scrollbar">
          <div class="sticky top-0 bg-[#212121]/80 backdrop-blur-lg z-10 pb-4">
            <h2 class="text-white font-medium text-lg mb-4">Assets</h2>
            <div class="border-2 border-dashed border-neutral-700 rounded-xl p-4 text-center hover:border-emerald-500 transition-colors">
              <input type="file" id="asset-upload" accept="image/*" multiple class="hidden" onchange="handleAssetUpload(event)">
              <button onclick="document.getElementById('asset-upload').click()" class="w-full">
                <!-- Changed assets icon (photograph icon) -->
                <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 mx-auto mb-2 text-neutral-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7h18M3 7a2 2 0 012-2h3.5a2 2 0 011.79 1.11L12 10.25l1.71-3.14A2 2 0 0115.5 5H19a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V7z" />
                </svg>
                <p class="text-sm text-neutral-400">Drop files here or click to upload</p>
              </button>
            </div>
          </div>
          <!-- Assets grid -->
          <div id="assets-grid" class="grid grid-cols-3 gap-3 mt-4"></div>
        </div>
        <div id="adjustments-panel" class="p-6 hidden">
          <h2 class="text-white font-medium text-lg mb-4">Adjustments</h2>
          <div class="space-y-4">
            <div class="space-y-2">
              <label class="text-sm text-neutral-400">Brightness</label>
              <input type="range" min="0" max="200" class="w-full accent-emerald-500">
            </div>
            <div class="space-y-2">
              <label class="text-sm text-neutral-400">Contrast</label>
              <input type="range" min="0" max="200" class="w-full accent-emerald-500">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="script.js"></script>
</body>
</html>
    